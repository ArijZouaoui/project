{"ast":null,"code":"/*!\nFullCalendar Resource Timeline Plugin v4.4.0\nDocs & License: https://fullcalendar.io/scheduler\n(c) 2019 Adam Shaw\n*/\nimport { removeElement, Component, memoizeRendering, createElement, htmlToElement, htmlEscape, isArraysEqual, EmitterMixin, memoize, parseFieldSpecs, PositionCache, applyStyleProp, View, createPlugin } from '@fullcalendar/core';\nimport TimelinePlugin, { TimelineLane, HeaderBodyLayout, TimeAxis, ScrollJoiner, StickyScroller } from '@fullcalendar/timeline';\nimport ResourceCommonPlugin, { isGroupsEqual, buildResourceFields, buildResourceTextFunc, ResourceApi, ResourceSplitter, buildRowNodes } from '@fullcalendar/resource-common';\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\n\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n  };\n\n  return extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar Row =\n/** @class */\nfunction (_super) {\n  __extends(Row, _super);\n\n  function Row(spreadsheetParent, spreadsheetNextSibling, timeAxisParent, timeAxisNextSibling) {\n    var _this = _super.call(this) || this;\n\n    _this.isSizeDirty = false;\n    spreadsheetParent.insertBefore(_this.spreadsheetTr = document.createElement('tr'), spreadsheetNextSibling);\n    timeAxisParent.insertBefore(_this.timeAxisTr = document.createElement('tr'), timeAxisNextSibling);\n    return _this;\n  }\n\n  Row.prototype.destroy = function () {\n    removeElement(this.spreadsheetTr);\n    removeElement(this.timeAxisTr);\n\n    _super.prototype.destroy.call(this);\n  };\n\n  Row.prototype.updateSize = function (isResize) {\n    this.isSizeDirty = false;\n  };\n\n  return Row;\n}(Component);\n\nfunction updateExpanderIcon(el, isExpanded) {\n  var classList = el.classList;\n\n  if (isExpanded) {\n    classList.remove('fc-icon-plus-square');\n    classList.add('fc-icon-minus-square');\n  } else {\n    classList.remove('fc-icon-minus-square');\n    classList.add('fc-icon-plus-square');\n  }\n}\n\nfunction clearExpanderIcon(el) {\n  var classList = el.classList;\n  classList.remove('fc-icon-minus-square');\n  classList.remove('fc-icon-plus-square');\n}\n\nfunction updateTrResourceId(tr, resourceId) {\n  tr.setAttribute('data-resource-id', resourceId);\n}\n\nvar GroupRow =\n/** @class */\nfunction (_super) {\n  __extends(GroupRow, _super);\n\n  function GroupRow() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this._renderCells = memoizeRendering(_this.renderCells, _this.unrenderCells);\n    _this._updateExpanderIcon = memoizeRendering(_this.updateExpanderIcon, null, [_this._renderCells]);\n\n    _this.onExpanderClick = function (ev) {\n      var props = _this.props;\n\n      _this.context.calendar.dispatch({\n        type: 'SET_RESOURCE_ENTITY_EXPANDED',\n        id: props.id,\n        isExpanded: !props.isExpanded\n      });\n    };\n\n    return _this;\n  }\n\n  GroupRow.prototype.render = function (props) {\n    this._renderCells(props.group, props.spreadsheetColCnt);\n\n    this._updateExpanderIcon(props.isExpanded);\n\n    this.isSizeDirty = true;\n  };\n\n  GroupRow.prototype.destroy = function () {\n    _super.prototype.destroy.call(this);\n\n    this._renderCells.unrender(); // should unrender everything else\n\n  };\n\n  GroupRow.prototype.renderCells = function (group, spreadsheetColCnt) {\n    var spreadsheetContentEl = this.renderSpreadsheetContent(group);\n    this.spreadsheetTr.appendChild(createElement('td', {\n      className: 'fc-divider',\n      colSpan: spreadsheetColCnt // span across all columns\n\n    }, this.spreadsheetHeightEl = createElement('div', null, spreadsheetContentEl)) // needed by setTrInnerHeight\n    );\n    this.expanderIconEl = spreadsheetContentEl.querySelector('.fc-icon');\n    this.expanderIconEl.parentElement.addEventListener('click', this.onExpanderClick); // insert a single cell, with a single empty <div>.\n    // there will be no content\n\n    this.timeAxisTr.appendChild(createElement('td', {\n      className: 'fc-divider'\n    }, this.timeAxisHeightEl = document.createElement('div')));\n  };\n\n  GroupRow.prototype.unrenderCells = function () {\n    this.spreadsheetTr.innerHTML = '';\n    this.timeAxisTr.innerHTML = '';\n  };\n  /*\n  Renders the content wrapper element that will be inserted into this row's TD cell.\n  */\n\n\n  GroupRow.prototype.renderSpreadsheetContent = function (group) {\n    var text = this.renderCellText(group);\n    var contentEl = htmlToElement('<div class=\"fc-cell-content\">' + '<span class=\"fc-expander\">' + '<span class=\"fc-icon\"></span>' + '</span>' + '<span class=\"fc-cell-text\">' + (text ? htmlEscape(text) : '&nbsp;') + '</span>' + '</div>');\n    var filter = group.spec.render;\n\n    if (typeof filter === 'function') {\n      contentEl = filter(contentEl, group.value) || contentEl;\n    }\n\n    return contentEl;\n  };\n\n  GroupRow.prototype.renderCellText = function (group) {\n    var text = group.value || ''; // might be null/undefined if an ad-hoc grouping\n\n    var filter = group.spec.text;\n\n    if (typeof filter === 'function') {\n      text = filter(text) || text;\n    }\n\n    return text;\n  };\n\n  GroupRow.prototype.getHeightEls = function () {\n    return [this.spreadsheetHeightEl, this.timeAxisHeightEl];\n  };\n\n  GroupRow.prototype.updateExpanderIcon = function (isExpanded) {\n    updateExpanderIcon(this.expanderIconEl, isExpanded);\n  };\n\n  return GroupRow;\n}(Row);\n\nGroupRow.addEqualityFuncs({\n  group: isGroupsEqual // HACK for ResourceTimelineView::renderRows\n\n});\n\nvar SpreadsheetRow =\n/** @class */\nfunction (_super) {\n  __extends(SpreadsheetRow, _super);\n\n  function SpreadsheetRow(tr) {\n    var _this = _super.call(this) || this;\n\n    _this._renderRow = memoizeRendering(_this.renderRow, _this.unrenderRow);\n    _this._updateTrResourceId = memoizeRendering(updateTrResourceId, null, [_this._renderRow]);\n    _this._updateExpanderIcon = memoizeRendering(_this.updateExpanderIcon, null, [_this._renderRow]);\n\n    _this.onExpanderClick = function (ev) {\n      var props = _this.props;\n\n      _this.context.calendar.dispatch({\n        type: 'SET_RESOURCE_ENTITY_EXPANDED',\n        id: props.id,\n        isExpanded: !props.isExpanded\n      });\n    };\n\n    _this.tr = tr;\n    return _this;\n  }\n\n  SpreadsheetRow.prototype.render = function (props) {\n    this._renderRow(props.resource, props.rowSpans, props.depth, props.colSpecs);\n\n    this._updateTrResourceId(this.tr, props.resource.id); // TODO: only use public ID?\n\n\n    this._updateExpanderIcon(props.hasChildren, props.isExpanded);\n  };\n\n  SpreadsheetRow.prototype.destroy = function () {\n    _super.prototype.destroy.call(this);\n\n    this._renderRow.unrender(); // should unrender everything else\n\n  };\n\n  SpreadsheetRow.prototype.renderRow = function (resource, rowSpans, depth, colSpecs) {\n    var _a = this.context,\n        calendar = _a.calendar,\n        view = _a.view,\n        theme = _a.theme;\n    var tr = this.tr;\n    var resourceFields = buildResourceFields(resource); // slightly inefficient. already done up the call stack\n\n    var mainTd;\n\n    for (var i = 0; i < colSpecs.length; i++) {\n      var colSpec = colSpecs[i];\n      var rowSpan = rowSpans[i];\n\n      if (rowSpan === 0) {\n        // not responsible for group-based rows. VRowGroup is\n        continue;\n      } else if (rowSpan == null) {\n        rowSpan = 1;\n      }\n\n      var text = void 0;\n\n      if (colSpec.field) {\n        text = resourceFields[colSpec.field];\n      } else {\n        text = buildResourceTextFunc(colSpec.text, calendar)(resource);\n      }\n\n      var contentEl = htmlToElement('<div class=\"fc-cell-content\">' + (colSpec.isMain ? renderIconHtml(depth) : '') + '<span class=\"fc-cell-text\">' + (text ? htmlEscape(text) : '&nbsp;') + '</span>' + '</div>');\n\n      if (typeof colSpec.render === 'function') {\n        // a filter function for the element\n        contentEl = colSpec.render(new ResourceApi(calendar, resource), contentEl) || contentEl;\n      }\n\n      if (rowSpan > 1) {\n        contentEl.classList.add('fc-sticky');\n      }\n\n      var td = createElement('td', {\n        className: theme.getClass('widgetContent'),\n        rowspan: rowSpan\n      }, contentEl); // the first cell of the row needs to have an inner div for setTrInnerHeight\n\n      if (colSpec.isMain) {\n        td.appendChild(this.heightEl = createElement('div', null, td.childNodes) // inner wrap\n        );\n        mainTd = td;\n      }\n\n      tr.appendChild(td);\n    }\n\n    this.expanderIconEl = tr.querySelector('.fc-expander-space .fc-icon'); // wait until very end\n\n    calendar.publiclyTrigger('resourceRender', [{\n      resource: new ResourceApi(calendar, resource),\n      el: mainTd,\n      view: view\n    }]);\n  };\n\n  SpreadsheetRow.prototype.unrenderRow = function () {\n    this.tr.innerHTML = '';\n  };\n\n  SpreadsheetRow.prototype.updateExpanderIcon = function (hasChildren, isExpanded) {\n    var expanderIconEl = this.expanderIconEl;\n    var expanderEl = expanderIconEl.parentElement;\n\n    if (expanderIconEl && expanderEl // why would this be null?? was the case in IE11\n    ) {\n        if (hasChildren) {\n          expanderEl.addEventListener('click', this.onExpanderClick);\n          expanderEl.classList.add('fc-expander');\n          updateExpanderIcon(expanderIconEl, isExpanded);\n        } else {\n          expanderEl.removeEventListener('click', this.onExpanderClick);\n          expanderEl.classList.remove('fc-expander');\n          clearExpanderIcon(expanderIconEl);\n        }\n      }\n  };\n\n  return SpreadsheetRow;\n}(Component);\n/*\nRenders the HTML responsible for the subrow expander area,\nas well as the space before it (used to align expanders of similar depths)\n*/\n\n\nfunction renderIconHtml(depth) {\n  var html = '';\n\n  for (var i = 0; i < depth; i++) {\n    html += '<span class=\"fc-icon\"></span>';\n  }\n\n  html += '<span class=\"fc-expander-space\">' + '<span class=\"fc-icon\"></span>' + '</span>';\n  return html;\n}\n\nvar ResourceRow =\n/** @class */\nfunction (_super) {\n  __extends(ResourceRow, _super);\n\n  function ResourceRow(a, b, c, d, timeAxis) {\n    var _this = _super.call(this, a, b, c, d) || this;\n\n    _this.renderSkeleton = memoizeRendering(_this._renderSkeleton, _this._unrenderSkeleton);\n    _this.updateTrResourceId = memoizeRendering(updateTrResourceId);\n    _this.timeAxis = timeAxis;\n    return _this;\n  }\n\n  ResourceRow.prototype.render = function (props, context) {\n    this.renderSkeleton(context); // spreadsheetRow handles calling updateTrResourceId for spreadsheetTr\n\n    this.spreadsheetRow.receiveProps({\n      colSpecs: props.colSpecs,\n      id: props.id,\n      rowSpans: props.rowSpans,\n      depth: props.depth,\n      isExpanded: props.isExpanded,\n      hasChildren: props.hasChildren,\n      resource: props.resource\n    }, context);\n    this.updateTrResourceId(this.timeAxisTr, props.resource.id);\n    this.lane.receiveProps({\n      dateProfile: props.dateProfile,\n      nextDayThreshold: props.nextDayThreshold,\n      businessHours: props.businessHours,\n      eventStore: props.eventStore,\n      eventUiBases: props.eventUiBases,\n      dateSelection: props.dateSelection,\n      eventSelection: props.eventSelection,\n      eventDrag: props.eventDrag,\n      eventResize: props.eventResize\n    }, context);\n    this.isSizeDirty = true;\n  };\n\n  ResourceRow.prototype.destroy = function () {\n    this.renderSkeleton.unrender();\n\n    _super.prototype.destroy.call(this);\n  };\n\n  ResourceRow.prototype._renderSkeleton = function (context) {\n    this.timeAxisTr.appendChild(this.cellEl = createElement('td', {\n      className: context.theme.getClass('widgetContent')\n    }, this.innerContainerEl = document.createElement('div')));\n    this.spreadsheetRow = new SpreadsheetRow(this.spreadsheetTr);\n    this.lane = new TimelineLane(this.innerContainerEl, this.innerContainerEl, this.timeAxis);\n  };\n\n  ResourceRow.prototype._unrenderSkeleton = function () {\n    this.spreadsheetRow.destroy();\n    this.lane.destroy();\n    removeElement(this.cellEl);\n  };\n\n  ResourceRow.prototype.updateSize = function (isResize) {\n    _super.prototype.updateSize.call(this, isResize);\n\n    this.lane.updateSize(isResize);\n  };\n\n  ResourceRow.prototype.getHeightEls = function () {\n    return [this.spreadsheetRow.heightEl, this.innerContainerEl];\n  };\n\n  return ResourceRow;\n}(Row);\n\nResourceRow.addEqualityFuncs({\n  rowSpans: isArraysEqual // HACK for isSizeDirty, ResourceTimelineView::renderRows\n\n});\nvar COL_MIN_WIDTH = 30;\n\nvar SpreadsheetHeader =\n/** @class */\nfunction (_super) {\n  __extends(SpreadsheetHeader, _super);\n\n  function SpreadsheetHeader(parentEl) {\n    var _this = _super.call(this) || this;\n\n    _this.resizables = [];\n    _this.colWidths = [];\n    _this.emitter = new EmitterMixin();\n    _this.renderSkeleton = memoizeRendering(_this._renderSkeleton, _this._unrenderSkeleton);\n    _this.parentEl = parentEl;\n    return _this;\n  }\n\n  SpreadsheetHeader.prototype.render = function (props, context) {\n    this.renderSkeleton(context);\n    var theme = context.theme;\n    var colSpecs = props.colSpecs;\n    var html = '<colgroup>' + props.colTags + '</colgroup>' + '<tbody>';\n\n    if (props.superHeaderText) {\n      html += '<tr class=\"fc-super\">' + '<th class=\"' + theme.getClass('widgetHeader') + '\" colspan=\"' + colSpecs.length + '\">' + '<div class=\"fc-cell-content\">' + '<span class=\"fc-cell-text\">' + htmlEscape(props.superHeaderText) + '</span>' + '</div>' + '</th>' + '</tr>';\n    }\n\n    html += '<tr>';\n\n    for (var i = 0; i < colSpecs.length; i++) {\n      var o = colSpecs[i];\n      var isLast = i === colSpecs.length - 1;\n      html += \"<th class=\\\"\" + theme.getClass('widgetHeader') + \"\\\">\" + '<div>' + '<div class=\"fc-cell-content\">' + (o.isMain ? '<span class=\"fc-expander-space\">' + '<span class=\"fc-icon\"></span>' + '</span>' : '') + '<span class=\"fc-cell-text\">' + htmlEscape(o.labelText || '') + // what about normalizing this value ahead of time?\n      '</span>' + '</div>' + (!isLast ? '<div class=\"fc-col-resizer\"></div>' : '') + '</div>' + '</th>';\n    }\n\n    html += '</tr>';\n    html += '</tbody>';\n    this.tableEl.innerHTML = html;\n    this.thEls = Array.prototype.slice.call(this.tableEl.querySelectorAll('th'));\n    this.colEls = Array.prototype.slice.call(this.tableEl.querySelectorAll('col'));\n    this.resizerEls = Array.prototype.slice.call(this.tableEl.querySelectorAll('.fc-col-resizer'));\n    this.initColResizing();\n  };\n\n  SpreadsheetHeader.prototype.destroy = function () {\n    for (var _i = 0, _a = this.resizables; _i < _a.length; _i++) {\n      var resizable = _a[_i];\n      resizable.destroy();\n    }\n\n    this.renderSkeleton.unrender();\n\n    _super.prototype.destroy.call(this);\n  };\n\n  SpreadsheetHeader.prototype._renderSkeleton = function (context) {\n    this.parentEl.appendChild(this.tableEl = createElement('table', {\n      className: context.theme.getClass('tableGrid')\n    }));\n  };\n\n  SpreadsheetHeader.prototype._unrenderSkeleton = function () {\n    removeElement(this.tableEl);\n  };\n\n  SpreadsheetHeader.prototype.initColResizing = function () {\n    var _this = this;\n\n    var _a = this.context,\n        calendar = _a.calendar,\n        isRtl = _a.isRtl;\n    var ElementDraggingImpl = calendar.pluginSystem.hooks.elementDraggingImpl;\n\n    if (ElementDraggingImpl) {\n      this.resizables = this.resizerEls.map(function (handleEl, colIndex) {\n        var dragging = new ElementDraggingImpl(handleEl);\n        var startWidth;\n        dragging.emitter.on('dragstart', function () {\n          startWidth = _this.colWidths[colIndex];\n\n          if (typeof startWidth !== 'number') {\n            startWidth = _this.thEls[colIndex].getBoundingClientRect().width;\n          }\n        });\n        dragging.emitter.on('dragmove', function (pev) {\n          _this.colWidths[colIndex] = Math.max(startWidth + pev.deltaX * (isRtl ? -1 : 1), COL_MIN_WIDTH);\n\n          _this.emitter.trigger('colwidthchange', _this.colWidths);\n        });\n        dragging.setAutoScrollEnabled(false); // because gets weird with auto-scrolling time area\n\n        return dragging;\n      });\n    }\n  };\n\n  return SpreadsheetHeader;\n}(Component);\n\nvar Spreadsheet =\n/** @class */\nfunction (_super) {\n  __extends(Spreadsheet, _super);\n\n  function Spreadsheet(headParentEl, bodyParentEl) {\n    var _this = _super.call(this) || this;\n\n    _this.renderSkeleton = memoizeRendering(_this._renderSkeleton, _this._unrenderSkeleton);\n    _this.renderCells = memoizeRendering(_this._renderCells, _this._unrenderCells, [_this.renderSkeleton]);\n    _this.layout = new HeaderBodyLayout(headParentEl, bodyParentEl, 'clipped-scroll');\n    return _this;\n  }\n\n  Spreadsheet.prototype.render = function (props, context) {\n    this.renderSkeleton(context);\n    this.renderCells(props.superHeaderText, props.colSpecs);\n  };\n\n  Spreadsheet.prototype.destroy = function () {\n    this.renderCells.unrender();\n    this.renderSkeleton.unrender();\n    this.layout.destroy();\n\n    _super.prototype.destroy.call(this);\n  };\n\n  Spreadsheet.prototype._renderSkeleton = function (context) {\n    var _this = this;\n\n    var bodyEnhancedScroller = this.layout.bodyScroller.enhancedScroll;\n    bodyEnhancedScroller.canvas.contentEl.appendChild(this.bodyContainerEl = createElement('div', {\n      className: 'fc-rows'\n    }, '<table>' + '<colgroup />' + '<tbody />' + '</table>'));\n    this.bodyColGroup = this.bodyContainerEl.querySelector('colgroup');\n    this.bodyTbody = this.bodyContainerEl.querySelector('tbody');\n    var headerEnhancedScroller = this.layout.headerScroller.enhancedScroll;\n    this.header = new SpreadsheetHeader(headerEnhancedScroller.canvas.contentEl);\n    this.header.emitter.on('colwidthchange', function (colWidths) {\n      _this.applyColWidths(colWidths);\n    });\n  };\n\n  Spreadsheet.prototype._unrenderSkeleton = function () {\n    this.header.destroy();\n  };\n\n  Spreadsheet.prototype._renderCells = function (superHeaderText, colSpecs) {\n    var colTags = this.renderColTags(colSpecs);\n    this.header.receiveProps({\n      superHeaderText: superHeaderText,\n      colSpecs: colSpecs,\n      colTags: colTags\n    }, this.context);\n    this.bodyColGroup.innerHTML = colTags;\n    this.bodyColEls = Array.prototype.slice.call(this.bodyColGroup.querySelectorAll('col'));\n    this.applyColWidths(colSpecs.map(function (colSpec) {\n      return colSpec.width;\n    }));\n  };\n\n  Spreadsheet.prototype._unrenderCells = function () {\n    this.bodyColGroup.innerHTML = '';\n  };\n\n  Spreadsheet.prototype.renderColTags = function (colSpecs) {\n    var html = '';\n\n    for (var _i = 0, colSpecs_1 = colSpecs; _i < colSpecs_1.length; _i++) {\n      var o = colSpecs_1[_i];\n\n      if (o.isMain) {\n        html += '<col class=\"fc-main-col\"/>';\n      } else {\n        html += '<col/>';\n      }\n    }\n\n    return html;\n  };\n\n  Spreadsheet.prototype.updateSize = function (isResize, totalHeight, isAuto) {\n    this.layout.setHeight(totalHeight, isAuto);\n  };\n\n  Spreadsheet.prototype.applyColWidths = function (colWidths) {\n    var _this = this;\n\n    colWidths.forEach(function (colWidth, colIndex) {\n      var headEl = _this.header.colEls[colIndex]; // bad to access child\n\n      var bodyEl = _this.bodyColEls[colIndex];\n      var styleVal;\n\n      if (typeof colWidth === 'number') {\n        styleVal = colWidth + 'px';\n      } else if (typeof colWidth == null) {\n        styleVal = '';\n      }\n\n      headEl.style.width = bodyEl.style.width = styleVal;\n    });\n  };\n\n  return Spreadsheet;\n}(Component);\n\nvar MIN_RESOURCE_AREA_WIDTH = 30; // definitely bigger than scrollbars\n\nvar ResourceTimelineView =\n/** @class */\nfunction (_super) {\n  __extends(ResourceTimelineView, _super);\n\n  function ResourceTimelineView() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.isStickyScrollDirty = false;\n    _this.rowNodes = [];\n    _this.rowComponents = [];\n    _this.rowComponentsById = {};\n    _this.resourceAreaWidthDraggings = [];\n    _this.splitter = new ResourceSplitter(); // doesn't let it do businessHours tho\n\n    _this.renderSkeleton = memoizeRendering(_this._renderSkeleton, _this._unrenderSkeleton);\n    _this.hasResourceBusinessHours = memoize(hasResourceBusinessHours);\n    _this.buildRowNodes = memoize(buildRowNodes);\n    _this.hasNesting = memoize(hasNesting);\n    _this.updateHasNesting = memoizeRendering(_this._updateHasNesting);\n    _this.startInteractive = memoizeRendering(_this._startInteractive, _this._stopInteractive);\n    return _this;\n  }\n\n  ResourceTimelineView.prototype._startInteractive = function (timeAxisEl) {\n    this.context.calendar.registerInteractiveComponent(this, {\n      el: timeAxisEl\n    });\n  };\n\n  ResourceTimelineView.prototype._stopInteractive = function () {\n    this.context.calendar.unregisterInteractiveComponent(this);\n  };\n\n  ResourceTimelineView.prototype.render = function (props, context) {\n    _super.prototype.render.call(this, props, context);\n\n    this.renderSkeleton(context);\n    var splitProps = this.splitter.splitProps(props);\n    var hasResourceBusinessHours = this.hasResourceBusinessHours(props.resourceStore);\n    this.spreadsheet.receiveProps({\n      superHeaderText: this.superHeaderText,\n      colSpecs: this.colSpecs\n    }, context);\n    this.timeAxis.receiveProps({\n      dateProfileGenerator: props.dateProfileGenerator,\n      dateProfile: props.dateProfile\n    }, context);\n    this.startInteractive(this.timeAxis.slats.el); // for all-resource bg events / selections / business-hours\n\n    this.lane.receiveProps(__assign({}, splitProps[''], {\n      dateProfile: props.dateProfile,\n      nextDayThreshold: context.nextDayThreshold,\n      businessHours: hasResourceBusinessHours ? null : props.businessHours\n    }), context);\n    var newRowNodes = this.buildRowNodes(props.resourceStore, this.groupSpecs, this.orderSpecs, this.isVGrouping, props.resourceEntityExpansions, context.options.resourcesInitiallyExpanded);\n    this.updateHasNesting(this.hasNesting(newRowNodes));\n    this.diffRows(newRowNodes);\n    this.updateRowProps(props.dateProfile, hasResourceBusinessHours ? props.businessHours : null, // CONFUSING, comment\n    splitProps);\n    this.startNowIndicator(props.dateProfile, props.dateProfileGenerator);\n  };\n\n  ResourceTimelineView.prototype._renderSkeleton = function (context) {\n    var options = context.options,\n        calendar = context.calendar;\n    var allColSpecs = options.resourceColumns || [];\n    var labelText = options.resourceLabelText; // TODO: view.override\n\n    var defaultLabelText = 'Resources'; // TODO: view.defaults\n\n    var superHeaderText = null;\n\n    if (!allColSpecs.length) {\n      allColSpecs.push({\n        labelText: labelText || defaultLabelText,\n        text: buildResourceTextFunc(options.resourceText, calendar)\n      });\n    } else {\n      superHeaderText = labelText;\n    }\n\n    var plainColSpecs = [];\n    var groupColSpecs = [];\n    var groupSpecs = [];\n    var isVGrouping = false;\n    var isHGrouping = false;\n\n    for (var _i = 0, allColSpecs_1 = allColSpecs; _i < allColSpecs_1.length; _i++) {\n      var colSpec = allColSpecs_1[_i];\n\n      if (colSpec.group) {\n        groupColSpecs.push(colSpec);\n      } else {\n        plainColSpecs.push(colSpec);\n      }\n    }\n\n    plainColSpecs[0].isMain = true;\n\n    if (groupColSpecs.length) {\n      groupSpecs = groupColSpecs;\n      isVGrouping = true;\n    } else {\n      var hGroupField = options.resourceGroupField;\n\n      if (hGroupField) {\n        isHGrouping = true;\n        groupSpecs.push({\n          field: hGroupField,\n          text: options.resourceGroupText,\n          render: options.resourceGroupRender\n        });\n      }\n    }\n\n    var allOrderSpecs = parseFieldSpecs(options.resourceOrder);\n    var plainOrderSpecs = [];\n\n    for (var _a = 0, allOrderSpecs_1 = allOrderSpecs; _a < allOrderSpecs_1.length; _a++) {\n      var orderSpec = allOrderSpecs_1[_a];\n      var isGroup = false;\n\n      for (var _b = 0, groupSpecs_1 = groupSpecs; _b < groupSpecs_1.length; _b++) {\n        var groupSpec = groupSpecs_1[_b];\n\n        if (groupSpec.field === orderSpec.field) {\n          groupSpec.order = orderSpec.order; // -1, 0, 1\n\n          isGroup = true;\n          break;\n        }\n      }\n\n      if (!isGroup) {\n        plainOrderSpecs.push(orderSpec);\n      }\n    }\n\n    this.superHeaderText = superHeaderText;\n    this.isVGrouping = isVGrouping;\n    this.isHGrouping = isHGrouping;\n    this.groupSpecs = groupSpecs;\n    this.colSpecs = groupColSpecs.concat(plainColSpecs);\n    this.orderSpecs = plainOrderSpecs; // START RENDERING...\n\n    this.el.classList.add('fc-timeline');\n\n    if (options.eventOverlap === false) {\n      this.el.classList.add('fc-no-overlap');\n    }\n\n    this.el.innerHTML = this.renderSkeletonHtml();\n    this.resourceAreaHeadEl = this.el.querySelector('thead .fc-resource-area');\n    this.setResourceAreaWidth(options.resourceAreaWidth);\n    this.initResourceAreaWidthDragging();\n    this.miscHeight = this.el.getBoundingClientRect().height;\n    this.spreadsheet = new Spreadsheet(this.resourceAreaHeadEl, this.el.querySelector('tbody .fc-resource-area'));\n    this.timeAxis = new TimeAxis(this.el.querySelector('thead .fc-time-area'), this.el.querySelector('tbody .fc-time-area'));\n    var timeAxisRowContainer = createElement('div', {\n      className: 'fc-rows'\n    }, '<table><tbody /></table>');\n    this.timeAxis.layout.bodyScroller.enhancedScroll.canvas.contentEl.appendChild(timeAxisRowContainer);\n    this.timeAxisTbody = timeAxisRowContainer.querySelector('tbody');\n    this.lane = new TimelineLane(null, this.timeAxis.layout.bodyScroller.enhancedScroll.canvas.bgEl, this.timeAxis);\n    this.bodyScrollJoiner = new ScrollJoiner('vertical', [this.spreadsheet.layout.bodyScroller, this.timeAxis.layout.bodyScroller]); // after scrolljoiner\n\n    this.spreadsheetBodyStickyScroller = new StickyScroller(this.spreadsheet.layout.bodyScroller.enhancedScroll, context.isRtl, true // isVertical\n    );\n  };\n\n  ResourceTimelineView.prototype._unrenderSkeleton = function (context) {\n    this.startInteractive.unrender(); // \"unrender\" bad name\n\n    this.destroyRows(); // wierd to call this here\n\n    this.spreadsheet.destroy();\n    this.timeAxis.destroy();\n    this.lane.destroy();\n    this.spreadsheetBodyStickyScroller.destroy();\n    this.el.classList.remove('fc-timeline');\n    this.el.classList.remove('fc-no-overlap');\n  };\n\n  ResourceTimelineView.prototype.renderSkeletonHtml = function () {\n    var theme = this.context.theme;\n    return \"<table class=\\\"\" + theme.getClass('tableGrid') + \"\\\"> <thead class=\\\"fc-head\\\"> <tr> <td class=\\\"fc-resource-area \" + theme.getClass('widgetHeader') + \"\\\"></td> <td class=\\\"fc-divider fc-col-resizer \" + theme.getClass('widgetHeader') + \"\\\"></td> <td class=\\\"fc-time-area \" + theme.getClass('widgetHeader') + \"\\\"></td> </tr> </thead> <tbody class=\\\"fc-body\\\"> <tr> <td class=\\\"fc-resource-area \" + theme.getClass('widgetContent') + \"\\\"></td> <td class=\\\"fc-divider fc-col-resizer \" + theme.getClass('widgetHeader') + \"\\\"></td> <td class=\\\"fc-time-area \" + theme.getClass('widgetContent') + \"\\\"></td> </tr> </tbody> </table>\";\n  };\n\n  ResourceTimelineView.prototype._updateHasNesting = function (isNesting) {\n    var classList = this.el.classList;\n\n    if (isNesting) {\n      classList.remove('fc-flat');\n    } else {\n      classList.add('fc-flat');\n    }\n  };\n\n  ResourceTimelineView.prototype.diffRows = function (newNodes) {\n    var oldNodes = this.rowNodes;\n    var oldLen = oldNodes.length;\n    var oldIndexHash = {}; // id -> index\n\n    var oldI = 0;\n    var newI = 0;\n\n    for (oldI = 0; oldI < oldLen; oldI++) {\n      oldIndexHash[oldNodes[oldI].id] = oldI;\n    } // iterate new nodes\n\n\n    for (oldI = 0, newI = 0; newI < newNodes.length; newI++) {\n      var newNode = newNodes[newI];\n      var oldIFound = oldIndexHash[newNode.id];\n\n      if (oldIFound != null && oldIFound >= oldI) {\n        this.removeRows(newI, oldIFound - oldI, oldNodes); // won't do anything if same index\n\n        oldI = oldIFound + 1;\n      } else {\n        this.addRow(newI, newNode);\n      }\n    } // old rows that weren't found need to be removed\n\n\n    this.removeRows(newI, oldLen - oldI, oldNodes); // won't do anything if same index\n\n    this.rowNodes = newNodes;\n  };\n  /*\n  rowComponents is the in-progress result\n  */\n\n\n  ResourceTimelineView.prototype.addRow = function (index, rowNode) {\n    var _a = this,\n        rowComponents = _a.rowComponents,\n        rowComponentsById = _a.rowComponentsById;\n\n    var nextComponent = rowComponents[index];\n    var newComponent = this.buildChildComponent(rowNode, this.spreadsheet.bodyTbody, nextComponent ? nextComponent.spreadsheetTr : null, this.timeAxisTbody, nextComponent ? nextComponent.timeAxisTr : null);\n    rowComponents.splice(index, 0, newComponent);\n    rowComponentsById[rowNode.id] = newComponent;\n  };\n\n  ResourceTimelineView.prototype.removeRows = function (startIndex, len, oldRowNodes) {\n    if (len) {\n      var _a = this,\n          rowComponents = _a.rowComponents,\n          rowComponentsById = _a.rowComponentsById;\n\n      for (var i = 0; i < len; i++) {\n        var rowComponent = rowComponents[startIndex + i];\n        rowComponent.destroy();\n        delete rowComponentsById[oldRowNodes[i].id];\n      }\n\n      rowComponents.splice(startIndex, len);\n    }\n  };\n\n  ResourceTimelineView.prototype.buildChildComponent = function (node, spreadsheetTbody, spreadsheetNext, timeAxisTbody, timeAxisNext) {\n    if (node.group) {\n      return new GroupRow(spreadsheetTbody, spreadsheetNext, timeAxisTbody, timeAxisNext);\n    } else if (node.resource) {\n      return new ResourceRow(spreadsheetTbody, spreadsheetNext, timeAxisTbody, timeAxisNext, this.timeAxis);\n    }\n  };\n\n  ResourceTimelineView.prototype.updateRowProps = function (dateProfile, fallbackBusinessHours, splitProps) {\n    var _a = this,\n        rowNodes = _a.rowNodes,\n        rowComponents = _a.rowComponents,\n        context = _a.context;\n\n    for (var i = 0; i < rowNodes.length; i++) {\n      var rowNode = rowNodes[i];\n      var rowComponent = rowComponents[i];\n\n      if (rowNode.group) {\n        rowComponent.receiveProps({\n          spreadsheetColCnt: this.colSpecs.length,\n          id: rowNode.id,\n          isExpanded: rowNode.isExpanded,\n          group: rowNode.group\n        }, context);\n      } else {\n        var resource = rowNode.resource;\n        rowComponent.receiveProps(__assign({}, splitProps[resource.id], {\n          dateProfile: dateProfile,\n          nextDayThreshold: context.nextDayThreshold,\n          businessHours: resource.businessHours || fallbackBusinessHours,\n          colSpecs: this.colSpecs,\n          id: rowNode.id,\n          rowSpans: rowNode.rowSpans,\n          depth: rowNode.depth,\n          isExpanded: rowNode.isExpanded,\n          hasChildren: rowNode.hasChildren,\n          resource: rowNode.resource\n        }), context);\n      }\n    }\n  };\n\n  ResourceTimelineView.prototype.updateSize = function (isResize, viewHeight, isAuto) {\n    // FYI: this ordering is really important\n    var calendar = this.context.calendar;\n    var isBaseSizing = isResize || calendar.isViewUpdated || calendar.isDatesUpdated || calendar.isEventsUpdated;\n\n    if (isBaseSizing) {\n      this.syncHeadHeights();\n    } // TODO: don't always call these (but guarding behind isBaseSizing was unreliable)\n\n\n    this.timeAxis.updateSize(isResize, viewHeight - this.miscHeight, isAuto);\n    this.spreadsheet.updateSize(isResize, viewHeight - this.miscHeight, isAuto);\n    var rowSizingCnt = this.updateRowSizes(isResize);\n    this.lane.updateSize(isResize); // is efficient. uses flags\n\n    if (isBaseSizing || rowSizingCnt) {\n      this.bodyScrollJoiner.update();\n      this.timeAxis.layout.scrollJoiner.update(); // hack\n\n      this.rowPositions = new PositionCache(this.timeAxis.slats.el, this.rowComponents.map(function (rowComponent) {\n        return rowComponent.timeAxisTr;\n      }), false, // isHorizontal\n      true // isVertical\n      );\n      this.rowPositions.build();\n      this.isStickyScrollDirty = true;\n    }\n  };\n\n  ResourceTimelineView.prototype.syncHeadHeights = function () {\n    var spreadsheetHeadEl = this.spreadsheet.header.tableEl;\n    var timeAxisHeadEl = this.timeAxis.header.tableEl;\n    spreadsheetHeadEl.style.height = '';\n    timeAxisHeadEl.style.height = '';\n    var max = Math.max(spreadsheetHeadEl.getBoundingClientRect().height, timeAxisHeadEl.getBoundingClientRect().height);\n    spreadsheetHeadEl.style.height = timeAxisHeadEl.style.height = max + 'px';\n  };\n\n  ResourceTimelineView.prototype.updateRowSizes = function (isResize) {\n    var dirtyRowComponents = this.rowComponents;\n\n    if (!isResize) {\n      dirtyRowComponents = dirtyRowComponents.filter(function (rowComponent) {\n        return rowComponent.isSizeDirty;\n      });\n    }\n\n    var elArrays = dirtyRowComponents.map(function (rowComponent) {\n      return rowComponent.getHeightEls();\n    }); // reset to natural heights\n\n    for (var _i = 0, elArrays_1 = elArrays; _i < elArrays_1.length; _i++) {\n      var elArray = elArrays_1[_i];\n\n      for (var _a = 0, elArray_1 = elArray; _a < elArray_1.length; _a++) {\n        var el = elArray_1[_a];\n        el.style.height = '';\n      }\n    } // let rows update their contents' heights\n\n\n    for (var _b = 0, dirtyRowComponents_1 = dirtyRowComponents; _b < dirtyRowComponents_1.length; _b++) {\n      var rowComponent = dirtyRowComponents_1[_b];\n      rowComponent.updateSize(isResize); // will reset isSizeDirty\n    }\n\n    var maxHeights = elArrays.map(function (elArray) {\n      var maxHeight = null;\n\n      for (var _i = 0, elArray_2 = elArray; _i < elArray_2.length; _i++) {\n        var el = elArray_2[_i];\n        var height = el.getBoundingClientRect().height;\n\n        if (maxHeight === null || height > maxHeight) {\n          maxHeight = height;\n        }\n      }\n\n      return maxHeight;\n    });\n\n    for (var i = 0; i < elArrays.length; i++) {\n      for (var _c = 0, _d = elArrays[i]; _c < _d.length; _c++) {\n        var el = _d[_c];\n        el.style.height = maxHeights[i] + 'px';\n      }\n    }\n\n    return dirtyRowComponents.length;\n  };\n\n  ResourceTimelineView.prototype.destroyRows = function () {\n    for (var _i = 0, _a = this.rowComponents; _i < _a.length; _i++) {\n      var rowComponent = _a[_i];\n      rowComponent.destroy();\n    }\n\n    this.rowNodes = [];\n    this.rowComponents = [];\n  };\n\n  ResourceTimelineView.prototype.destroy = function () {\n    for (var _i = 0, _a = this.resourceAreaWidthDraggings; _i < _a.length; _i++) {\n      var resourceAreaWidthDragging = _a[_i];\n      resourceAreaWidthDragging.destroy();\n    }\n\n    this.renderSkeleton.unrender(); // will call destroyRows\n\n    _super.prototype.destroy.call(this);\n  }; // Now Indicator\n  // ------------------------------------------------------------------------------------------\n\n\n  ResourceTimelineView.prototype.getNowIndicatorUnit = function (dateProfile, dateProfileGenerator) {\n    return this.timeAxis.getNowIndicatorUnit(dateProfile, dateProfileGenerator);\n  };\n\n  ResourceTimelineView.prototype.renderNowIndicator = function (date) {\n    this.timeAxis.renderNowIndicator(date);\n  };\n\n  ResourceTimelineView.prototype.unrenderNowIndicator = function () {\n    this.timeAxis.unrenderNowIndicator();\n  }; // Scrolling\n  // ------------------------------------------------------------------------------------------------------------------\n  // this is useful for scrolling prev/next dates while resource is scrolled down\n\n\n  ResourceTimelineView.prototype.queryScroll = function () {\n    var scroll = _super.prototype.queryScroll.call(this);\n\n    if (this.props.resourceStore) {\n      __assign(scroll, this.queryResourceScroll());\n    }\n\n    return scroll;\n  };\n\n  ResourceTimelineView.prototype.applyScroll = function (scroll, isResize) {\n    _super.prototype.applyScroll.call(this, scroll, isResize);\n\n    if (this.props.resourceStore) {\n      this.applyResourceScroll(scroll);\n    } // avoid updating stickyscroll too often\n\n\n    if (isResize || this.isStickyScrollDirty) {\n      this.isStickyScrollDirty = false;\n      this.spreadsheetBodyStickyScroller.updateSize();\n      this.timeAxis.updateStickyScrollers();\n    }\n  };\n\n  ResourceTimelineView.prototype.computeDateScroll = function (duration) {\n    return this.timeAxis.computeDateScroll(duration);\n  };\n\n  ResourceTimelineView.prototype.queryDateScroll = function () {\n    return this.timeAxis.queryDateScroll();\n  };\n\n  ResourceTimelineView.prototype.applyDateScroll = function (scroll) {\n    this.timeAxis.applyDateScroll(scroll);\n  };\n\n  ResourceTimelineView.prototype.queryResourceScroll = function () {\n    var _a = this,\n        rowComponents = _a.rowComponents,\n        rowNodes = _a.rowNodes;\n\n    var scroll = {};\n    var scrollerTop = this.timeAxis.layout.bodyScroller.el.getBoundingClientRect().top; // fixed position\n\n    for (var i = 0; i < rowComponents.length; i++) {\n      var rowComponent = rowComponents[i];\n      var rowNode = rowNodes[i];\n      var el = rowComponent.timeAxisTr;\n      var elBottom = el.getBoundingClientRect().bottom; // fixed position\n\n      if (elBottom > scrollerTop) {\n        scroll.rowId = rowNode.id;\n        scroll.bottom = elBottom - scrollerTop;\n        break;\n      }\n    } // TODO: what about left scroll state for spreadsheet area?\n\n\n    return scroll;\n  };\n\n  ResourceTimelineView.prototype.applyResourceScroll = function (scroll) {\n    var rowId = scroll.forcedRowId || scroll.rowId;\n\n    if (rowId) {\n      var rowComponent = this.rowComponentsById[rowId];\n\n      if (rowComponent) {\n        var el = rowComponent.timeAxisTr;\n\n        if (el) {\n          var innerTop = this.timeAxis.layout.bodyScroller.enhancedScroll.canvas.el.getBoundingClientRect().top;\n          var rowRect = el.getBoundingClientRect();\n          var scrollTop = (scroll.forcedRowId ? rowRect.top : // just use top edge\n          rowRect.bottom - scroll.bottom) - // pixels from bottom edge\n          innerTop;\n          this.timeAxis.layout.bodyScroller.enhancedScroll.setScrollTop(scrollTop);\n          this.spreadsheet.layout.bodyScroller.enhancedScroll.setScrollTop(scrollTop);\n        }\n      }\n    }\n  }; // TODO: scrollToResource\n  // Hit System\n  // ------------------------------------------------------------------------------------------\n\n\n  ResourceTimelineView.prototype.buildPositionCaches = function () {\n    this.timeAxis.slats.updateSize();\n    this.rowPositions.build();\n  };\n\n  ResourceTimelineView.prototype.queryHit = function (positionLeft, positionTop) {\n    var rowPositions = this.rowPositions;\n    var slats = this.timeAxis.slats;\n    var rowIndex = rowPositions.topToIndex(positionTop);\n\n    if (rowIndex != null) {\n      var resource = this.rowNodes[rowIndex].resource;\n\n      if (resource) {\n        // not a group\n        var slatHit = slats.positionToHit(positionLeft);\n\n        if (slatHit) {\n          return {\n            component: this,\n            dateSpan: {\n              range: slatHit.dateSpan.range,\n              allDay: slatHit.dateSpan.allDay,\n              resourceId: resource.id\n            },\n            rect: {\n              left: slatHit.left,\n              right: slatHit.right,\n              top: rowPositions.tops[rowIndex],\n              bottom: rowPositions.bottoms[rowIndex]\n            },\n            dayEl: slatHit.dayEl,\n            layer: 0\n          };\n        }\n      }\n    }\n  }; // Resource Area\n  // ------------------------------------------------------------------------------------------------------------------\n\n\n  ResourceTimelineView.prototype.setResourceAreaWidth = function (widthVal) {\n    this.resourceAreaWidth = widthVal;\n    applyStyleProp(this.resourceAreaHeadEl, 'width', widthVal || '');\n  };\n\n  ResourceTimelineView.prototype.initResourceAreaWidthDragging = function () {\n    var _this = this;\n\n    var _a = this.context,\n        calendar = _a.calendar,\n        isRtl = _a.isRtl;\n    var resourceAreaDividerEls = Array.prototype.slice.call(this.el.querySelectorAll('.fc-col-resizer'));\n    var ElementDraggingImpl = calendar.pluginSystem.hooks.elementDraggingImpl;\n\n    if (ElementDraggingImpl) {\n      this.resourceAreaWidthDraggings = resourceAreaDividerEls.map(function (el) {\n        var dragging = new ElementDraggingImpl(el);\n        var dragStartWidth;\n        var viewWidth;\n        dragging.emitter.on('dragstart', function () {\n          dragStartWidth = _this.resourceAreaWidth;\n\n          if (typeof dragStartWidth !== 'number') {\n            dragStartWidth = _this.resourceAreaHeadEl.getBoundingClientRect().width;\n          }\n\n          viewWidth = _this.el.getBoundingClientRect().width;\n        });\n        dragging.emitter.on('dragmove', function (pev) {\n          var newWidth = dragStartWidth + pev.deltaX * (isRtl ? -1 : 1);\n          newWidth = Math.max(newWidth, MIN_RESOURCE_AREA_WIDTH);\n          newWidth = Math.min(newWidth, viewWidth - MIN_RESOURCE_AREA_WIDTH);\n\n          _this.setResourceAreaWidth(newWidth);\n        });\n        dragging.setAutoScrollEnabled(false); // because gets weird with auto-scrolling time area\n\n        return dragging;\n      });\n    }\n  };\n\n  ResourceTimelineView.needsResourceData = true; // for ResourceViewProps\n\n  return ResourceTimelineView;\n}(View);\n\nfunction hasResourceBusinessHours(resourceStore) {\n  for (var resourceId in resourceStore) {\n    var resource = resourceStore[resourceId];\n\n    if (resource.businessHours) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction hasNesting(nodes) {\n  for (var _i = 0, nodes_1 = nodes; _i < nodes_1.length; _i++) {\n    var node = nodes_1[_i];\n\n    if (node.group) {\n      return true;\n    } else if (node.resource) {\n      if (node.hasChildren) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\nvar main = createPlugin({\n  deps: [ResourceCommonPlugin, TimelinePlugin],\n  defaultView: 'resourceTimelineDay',\n  views: {\n    resourceTimeline: {\n      class: ResourceTimelineView,\n      resourceAreaWidth: '30%',\n      resourcesInitiallyExpanded: true,\n      eventResizableFromStart: true // TODO: not DRY with this same setting in the main timeline config\n\n    },\n    resourceTimelineDay: {\n      type: 'resourceTimeline',\n      duration: {\n        days: 1\n      }\n    },\n    resourceTimelineWeek: {\n      type: 'resourceTimeline',\n      duration: {\n        weeks: 1\n      }\n    },\n    resourceTimelineMonth: {\n      type: 'resourceTimeline',\n      duration: {\n        months: 1\n      }\n    },\n    resourceTimelineYear: {\n      type: 'resourceTimeline',\n      duration: {\n        years: 1\n      }\n    }\n  }\n});\nexport default main;\nexport { ResourceTimelineView };","map":{"version":3,"sources":["C:/Users/Arij/projects/theone/node_modules/@fullcalendar/resource-timeline/main.esm.js"],"names":["removeElement","Component","memoizeRendering","createElement","htmlToElement","htmlEscape","isArraysEqual","EmitterMixin","memoize","parseFieldSpecs","PositionCache","applyStyleProp","View","createPlugin","TimelinePlugin","TimelineLane","HeaderBodyLayout","TimeAxis","ScrollJoiner","StickyScroller","ResourceCommonPlugin","isGroupsEqual","buildResourceFields","buildResourceTextFunc","ResourceApi","ResourceSplitter","buildRowNodes","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","Row","_super","spreadsheetParent","spreadsheetNextSibling","timeAxisParent","timeAxisNextSibling","_this","isSizeDirty","insertBefore","spreadsheetTr","document","timeAxisTr","destroy","updateSize","isResize","updateExpanderIcon","el","isExpanded","classList","remove","add","clearExpanderIcon","updateTrResourceId","tr","resourceId","setAttribute","GroupRow","_renderCells","renderCells","unrenderCells","_updateExpanderIcon","onExpanderClick","ev","props","context","calendar","dispatch","type","id","render","group","spreadsheetColCnt","unrender","spreadsheetContentEl","renderSpreadsheetContent","appendChild","className","colSpan","spreadsheetHeightEl","expanderIconEl","querySelector","parentElement","addEventListener","timeAxisHeightEl","innerHTML","text","renderCellText","contentEl","filter","spec","value","getHeightEls","addEqualityFuncs","SpreadsheetRow","_renderRow","renderRow","unrenderRow","_updateTrResourceId","resource","rowSpans","depth","colSpecs","hasChildren","_a","view","theme","resourceFields","mainTd","colSpec","rowSpan","field","isMain","renderIconHtml","td","getClass","rowspan","heightEl","childNodes","publiclyTrigger","expanderEl","removeEventListener","html","ResourceRow","a","c","timeAxis","renderSkeleton","_renderSkeleton","_unrenderSkeleton","spreadsheetRow","receiveProps","lane","dateProfile","nextDayThreshold","businessHours","eventStore","eventUiBases","dateSelection","eventSelection","eventDrag","eventResize","cellEl","innerContainerEl","COL_MIN_WIDTH","SpreadsheetHeader","parentEl","resizables","colWidths","emitter","colTags","superHeaderText","o","isLast","labelText","tableEl","thEls","slice","querySelectorAll","colEls","resizerEls","initColResizing","_i","resizable","isRtl","ElementDraggingImpl","pluginSystem","hooks","elementDraggingImpl","map","handleEl","colIndex","dragging","startWidth","on","getBoundingClientRect","width","pev","Math","max","deltaX","trigger","setAutoScrollEnabled","Spreadsheet","headParentEl","bodyParentEl","_unrenderCells","layout","bodyEnhancedScroller","bodyScroller","enhancedScroll","canvas","bodyContainerEl","bodyColGroup","bodyTbody","headerEnhancedScroller","headerScroller","header","applyColWidths","renderColTags","bodyColEls","colSpecs_1","totalHeight","isAuto","setHeight","forEach","colWidth","headEl","bodyEl","styleVal","style","MIN_RESOURCE_AREA_WIDTH","ResourceTimelineView","isStickyScrollDirty","rowNodes","rowComponents","rowComponentsById","resourceAreaWidthDraggings","splitter","hasResourceBusinessHours","hasNesting","updateHasNesting","_updateHasNesting","startInteractive","_startInteractive","_stopInteractive","timeAxisEl","registerInteractiveComponent","unregisterInteractiveComponent","splitProps","resourceStore","spreadsheet","dateProfileGenerator","slats","newRowNodes","groupSpecs","orderSpecs","isVGrouping","resourceEntityExpansions","options","resourcesInitiallyExpanded","diffRows","updateRowProps","startNowIndicator","allColSpecs","resourceColumns","resourceLabelText","defaultLabelText","push","resourceText","plainColSpecs","groupColSpecs","isHGrouping","allColSpecs_1","hGroupField","resourceGroupField","resourceGroupText","resourceGroupRender","allOrderSpecs","resourceOrder","plainOrderSpecs","allOrderSpecs_1","orderSpec","isGroup","_b","groupSpecs_1","groupSpec","order","concat","eventOverlap","renderSkeletonHtml","resourceAreaHeadEl","setResourceAreaWidth","resourceAreaWidth","initResourceAreaWidthDragging","miscHeight","height","timeAxisRowContainer","timeAxisTbody","bgEl","bodyScrollJoiner","spreadsheetBodyStickyScroller","destroyRows","isNesting","newNodes","oldNodes","oldLen","oldIndexHash","oldI","newI","newNode","oldIFound","removeRows","addRow","index","rowNode","nextComponent","newComponent","buildChildComponent","splice","startIndex","len","oldRowNodes","rowComponent","node","spreadsheetTbody","spreadsheetNext","timeAxisNext","fallbackBusinessHours","viewHeight","isBaseSizing","isViewUpdated","isDatesUpdated","isEventsUpdated","syncHeadHeights","rowSizingCnt","updateRowSizes","update","scrollJoiner","rowPositions","build","spreadsheetHeadEl","timeAxisHeadEl","dirtyRowComponents","elArrays","elArrays_1","elArray","elArray_1","dirtyRowComponents_1","maxHeights","maxHeight","elArray_2","_c","_d","resourceAreaWidthDragging","getNowIndicatorUnit","renderNowIndicator","date","unrenderNowIndicator","queryScroll","scroll","queryResourceScroll","applyScroll","applyResourceScroll","updateStickyScrollers","computeDateScroll","duration","queryDateScroll","applyDateScroll","scrollerTop","top","elBottom","bottom","rowId","forcedRowId","innerTop","rowRect","scrollTop","setScrollTop","buildPositionCaches","queryHit","positionLeft","positionTop","rowIndex","topToIndex","slatHit","positionToHit","component","dateSpan","range","allDay","rect","left","right","tops","bottoms","dayEl","layer","widthVal","resourceAreaDividerEls","dragStartWidth","viewWidth","newWidth","min","needsResourceData","nodes","nodes_1","main","deps","defaultView","views","resourceTimeline","class","eventResizableFromStart","resourceTimelineDay","days","resourceTimelineWeek","weeks","resourceTimelineMonth","months","resourceTimelineYear","years"],"mappings":"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","sourcesContent":["/*!\nFullCalendar Resource Timeline Plugin v4.4.0\nDocs & License: https://fullcalendar.io/scheduler\n(c) 2019 Adam Shaw\n*/\n\nimport { removeElement, Component, memoizeRendering, createElement, htmlToElement, htmlEscape, isArraysEqual, EmitterMixin, memoize, parseFieldSpecs, PositionCache, applyStyleProp, View, createPlugin } from '@fullcalendar/core';\nimport TimelinePlugin, { TimelineLane, HeaderBodyLayout, TimeAxis, ScrollJoiner, StickyScroller } from '@fullcalendar/timeline';\nimport ResourceCommonPlugin, { isGroupsEqual, buildResourceFields, buildResourceTextFunc, ResourceApi, ResourceSplitter, buildRowNodes } from '@fullcalendar/resource-common';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\n\nvar Row = /** @class */ (function (_super) {\n    __extends(Row, _super);\n    function Row(spreadsheetParent, spreadsheetNextSibling, timeAxisParent, timeAxisNextSibling) {\n        var _this = _super.call(this) || this;\n        _this.isSizeDirty = false;\n        spreadsheetParent.insertBefore(_this.spreadsheetTr = document.createElement('tr'), spreadsheetNextSibling);\n        timeAxisParent.insertBefore(_this.timeAxisTr = document.createElement('tr'), timeAxisNextSibling);\n        return _this;\n    }\n    Row.prototype.destroy = function () {\n        removeElement(this.spreadsheetTr);\n        removeElement(this.timeAxisTr);\n        _super.prototype.destroy.call(this);\n    };\n    Row.prototype.updateSize = function (isResize) {\n        this.isSizeDirty = false;\n    };\n    return Row;\n}(Component));\n\nfunction updateExpanderIcon(el, isExpanded) {\n    var classList = el.classList;\n    if (isExpanded) {\n        classList.remove('fc-icon-plus-square');\n        classList.add('fc-icon-minus-square');\n    }\n    else {\n        classList.remove('fc-icon-minus-square');\n        classList.add('fc-icon-plus-square');\n    }\n}\nfunction clearExpanderIcon(el) {\n    var classList = el.classList;\n    classList.remove('fc-icon-minus-square');\n    classList.remove('fc-icon-plus-square');\n}\nfunction updateTrResourceId(tr, resourceId) {\n    tr.setAttribute('data-resource-id', resourceId);\n}\n\nvar GroupRow = /** @class */ (function (_super) {\n    __extends(GroupRow, _super);\n    function GroupRow() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this._renderCells = memoizeRendering(_this.renderCells, _this.unrenderCells);\n        _this._updateExpanderIcon = memoizeRendering(_this.updateExpanderIcon, null, [_this._renderCells]);\n        _this.onExpanderClick = function (ev) {\n            var props = _this.props;\n            _this.context.calendar.dispatch({\n                type: 'SET_RESOURCE_ENTITY_EXPANDED',\n                id: props.id,\n                isExpanded: !props.isExpanded\n            });\n        };\n        return _this;\n    }\n    GroupRow.prototype.render = function (props) {\n        this._renderCells(props.group, props.spreadsheetColCnt);\n        this._updateExpanderIcon(props.isExpanded);\n        this.isSizeDirty = true;\n    };\n    GroupRow.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        this._renderCells.unrender(); // should unrender everything else\n    };\n    GroupRow.prototype.renderCells = function (group, spreadsheetColCnt) {\n        var spreadsheetContentEl = this.renderSpreadsheetContent(group);\n        this.spreadsheetTr.appendChild(createElement('td', {\n            className: 'fc-divider',\n            colSpan: spreadsheetColCnt // span across all columns\n        }, this.spreadsheetHeightEl = createElement('div', null, spreadsheetContentEl)) // needed by setTrInnerHeight\n        );\n        this.expanderIconEl = spreadsheetContentEl.querySelector('.fc-icon');\n        this.expanderIconEl.parentElement.addEventListener('click', this.onExpanderClick);\n        // insert a single cell, with a single empty <div>.\n        // there will be no content\n        this.timeAxisTr.appendChild(createElement('td', { className: 'fc-divider' }, this.timeAxisHeightEl = document.createElement('div')));\n    };\n    GroupRow.prototype.unrenderCells = function () {\n        this.spreadsheetTr.innerHTML = '';\n        this.timeAxisTr.innerHTML = '';\n    };\n    /*\n    Renders the content wrapper element that will be inserted into this row's TD cell.\n    */\n    GroupRow.prototype.renderSpreadsheetContent = function (group) {\n        var text = this.renderCellText(group);\n        var contentEl = htmlToElement('<div class=\"fc-cell-content\">' +\n            '<span class=\"fc-expander\">' +\n            '<span class=\"fc-icon\"></span>' +\n            '</span>' +\n            '<span class=\"fc-cell-text\">' +\n            (text ? htmlEscape(text) : '&nbsp;') +\n            '</span>' +\n            '</div>');\n        var filter = group.spec.render;\n        if (typeof filter === 'function') {\n            contentEl = filter(contentEl, group.value) || contentEl;\n        }\n        return contentEl;\n    };\n    GroupRow.prototype.renderCellText = function (group) {\n        var text = group.value || ''; // might be null/undefined if an ad-hoc grouping\n        var filter = group.spec.text;\n        if (typeof filter === 'function') {\n            text = filter(text) || text;\n        }\n        return text;\n    };\n    GroupRow.prototype.getHeightEls = function () {\n        return [this.spreadsheetHeightEl, this.timeAxisHeightEl];\n    };\n    GroupRow.prototype.updateExpanderIcon = function (isExpanded) {\n        updateExpanderIcon(this.expanderIconEl, isExpanded);\n    };\n    return GroupRow;\n}(Row));\nGroupRow.addEqualityFuncs({\n    group: isGroupsEqual // HACK for ResourceTimelineView::renderRows\n});\n\nvar SpreadsheetRow = /** @class */ (function (_super) {\n    __extends(SpreadsheetRow, _super);\n    function SpreadsheetRow(tr) {\n        var _this = _super.call(this) || this;\n        _this._renderRow = memoizeRendering(_this.renderRow, _this.unrenderRow);\n        _this._updateTrResourceId = memoizeRendering(updateTrResourceId, null, [_this._renderRow]);\n        _this._updateExpanderIcon = memoizeRendering(_this.updateExpanderIcon, null, [_this._renderRow]);\n        _this.onExpanderClick = function (ev) {\n            var props = _this.props;\n            _this.context.calendar.dispatch({\n                type: 'SET_RESOURCE_ENTITY_EXPANDED',\n                id: props.id,\n                isExpanded: !props.isExpanded\n            });\n        };\n        _this.tr = tr;\n        return _this;\n    }\n    SpreadsheetRow.prototype.render = function (props) {\n        this._renderRow(props.resource, props.rowSpans, props.depth, props.colSpecs);\n        this._updateTrResourceId(this.tr, props.resource.id); // TODO: only use public ID?\n        this._updateExpanderIcon(props.hasChildren, props.isExpanded);\n    };\n    SpreadsheetRow.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        this._renderRow.unrender(); // should unrender everything else\n    };\n    SpreadsheetRow.prototype.renderRow = function (resource, rowSpans, depth, colSpecs) {\n        var _a = this.context, calendar = _a.calendar, view = _a.view, theme = _a.theme;\n        var tr = this.tr;\n        var resourceFields = buildResourceFields(resource); // slightly inefficient. already done up the call stack\n        var mainTd;\n        for (var i = 0; i < colSpecs.length; i++) {\n            var colSpec = colSpecs[i];\n            var rowSpan = rowSpans[i];\n            if (rowSpan === 0) { // not responsible for group-based rows. VRowGroup is\n                continue;\n            }\n            else if (rowSpan == null) {\n                rowSpan = 1;\n            }\n            var text = void 0;\n            if (colSpec.field) {\n                text = resourceFields[colSpec.field];\n            }\n            else {\n                text = buildResourceTextFunc(colSpec.text, calendar)(resource);\n            }\n            var contentEl = htmlToElement('<div class=\"fc-cell-content\">' +\n                (colSpec.isMain ? renderIconHtml(depth) : '') +\n                '<span class=\"fc-cell-text\">' +\n                (text ? htmlEscape(text) : '&nbsp;') +\n                '</span>' +\n                '</div>');\n            if (typeof colSpec.render === 'function') { // a filter function for the element\n                contentEl = colSpec.render(new ResourceApi(calendar, resource), contentEl) || contentEl;\n            }\n            if (rowSpan > 1) {\n                contentEl.classList.add('fc-sticky');\n            }\n            var td = createElement('td', {\n                className: theme.getClass('widgetContent'),\n                rowspan: rowSpan\n            }, contentEl);\n            // the first cell of the row needs to have an inner div for setTrInnerHeight\n            if (colSpec.isMain) {\n                td.appendChild(this.heightEl = createElement('div', null, td.childNodes) // inner wrap\n                );\n                mainTd = td;\n            }\n            tr.appendChild(td);\n        }\n        this.expanderIconEl = tr.querySelector('.fc-expander-space .fc-icon');\n        // wait until very end\n        calendar.publiclyTrigger('resourceRender', [\n            {\n                resource: new ResourceApi(calendar, resource),\n                el: mainTd,\n                view: view\n            }\n        ]);\n    };\n    SpreadsheetRow.prototype.unrenderRow = function () {\n        this.tr.innerHTML = '';\n    };\n    SpreadsheetRow.prototype.updateExpanderIcon = function (hasChildren, isExpanded) {\n        var expanderIconEl = this.expanderIconEl;\n        var expanderEl = expanderIconEl.parentElement;\n        if (expanderIconEl &&\n            expanderEl // why would this be null?? was the case in IE11\n        ) {\n            if (hasChildren) {\n                expanderEl.addEventListener('click', this.onExpanderClick);\n                expanderEl.classList.add('fc-expander');\n                updateExpanderIcon(expanderIconEl, isExpanded);\n            }\n            else {\n                expanderEl.removeEventListener('click', this.onExpanderClick);\n                expanderEl.classList.remove('fc-expander');\n                clearExpanderIcon(expanderIconEl);\n            }\n        }\n    };\n    return SpreadsheetRow;\n}(Component));\n/*\nRenders the HTML responsible for the subrow expander area,\nas well as the space before it (used to align expanders of similar depths)\n*/\nfunction renderIconHtml(depth) {\n    var html = '';\n    for (var i = 0; i < depth; i++) {\n        html += '<span class=\"fc-icon\"></span>';\n    }\n    html +=\n        '<span class=\"fc-expander-space\">' +\n            '<span class=\"fc-icon\"></span>' +\n            '</span>';\n    return html;\n}\n\nvar ResourceRow = /** @class */ (function (_super) {\n    __extends(ResourceRow, _super);\n    function ResourceRow(a, b, c, d, timeAxis) {\n        var _this = _super.call(this, a, b, c, d) || this;\n        _this.renderSkeleton = memoizeRendering(_this._renderSkeleton, _this._unrenderSkeleton);\n        _this.updateTrResourceId = memoizeRendering(updateTrResourceId);\n        _this.timeAxis = timeAxis;\n        return _this;\n    }\n    ResourceRow.prototype.render = function (props, context) {\n        this.renderSkeleton(context);\n        // spreadsheetRow handles calling updateTrResourceId for spreadsheetTr\n        this.spreadsheetRow.receiveProps({\n            colSpecs: props.colSpecs,\n            id: props.id,\n            rowSpans: props.rowSpans,\n            depth: props.depth,\n            isExpanded: props.isExpanded,\n            hasChildren: props.hasChildren,\n            resource: props.resource\n        }, context);\n        this.updateTrResourceId(this.timeAxisTr, props.resource.id);\n        this.lane.receiveProps({\n            dateProfile: props.dateProfile,\n            nextDayThreshold: props.nextDayThreshold,\n            businessHours: props.businessHours,\n            eventStore: props.eventStore,\n            eventUiBases: props.eventUiBases,\n            dateSelection: props.dateSelection,\n            eventSelection: props.eventSelection,\n            eventDrag: props.eventDrag,\n            eventResize: props.eventResize\n        }, context);\n        this.isSizeDirty = true;\n    };\n    ResourceRow.prototype.destroy = function () {\n        this.renderSkeleton.unrender();\n        _super.prototype.destroy.call(this);\n    };\n    ResourceRow.prototype._renderSkeleton = function (context) {\n        this.timeAxisTr.appendChild(this.cellEl = createElement('td', { className: context.theme.getClass('widgetContent') }, this.innerContainerEl = document.createElement('div')));\n        this.spreadsheetRow = new SpreadsheetRow(this.spreadsheetTr);\n        this.lane = new TimelineLane(this.innerContainerEl, this.innerContainerEl, this.timeAxis);\n    };\n    ResourceRow.prototype._unrenderSkeleton = function () {\n        this.spreadsheetRow.destroy();\n        this.lane.destroy();\n        removeElement(this.cellEl);\n    };\n    ResourceRow.prototype.updateSize = function (isResize) {\n        _super.prototype.updateSize.call(this, isResize);\n        this.lane.updateSize(isResize);\n    };\n    ResourceRow.prototype.getHeightEls = function () {\n        return [this.spreadsheetRow.heightEl, this.innerContainerEl];\n    };\n    return ResourceRow;\n}(Row));\nResourceRow.addEqualityFuncs({\n    rowSpans: isArraysEqual // HACK for isSizeDirty, ResourceTimelineView::renderRows\n});\n\nvar COL_MIN_WIDTH = 30;\nvar SpreadsheetHeader = /** @class */ (function (_super) {\n    __extends(SpreadsheetHeader, _super);\n    function SpreadsheetHeader(parentEl) {\n        var _this = _super.call(this) || this;\n        _this.resizables = [];\n        _this.colWidths = [];\n        _this.emitter = new EmitterMixin();\n        _this.renderSkeleton = memoizeRendering(_this._renderSkeleton, _this._unrenderSkeleton);\n        _this.parentEl = parentEl;\n        return _this;\n    }\n    SpreadsheetHeader.prototype.render = function (props, context) {\n        this.renderSkeleton(context);\n        var theme = context.theme;\n        var colSpecs = props.colSpecs;\n        var html = '<colgroup>' + props.colTags + '</colgroup>' +\n            '<tbody>';\n        if (props.superHeaderText) {\n            html +=\n                '<tr class=\"fc-super\">' +\n                    '<th class=\"' + theme.getClass('widgetHeader') + '\" colspan=\"' + colSpecs.length + '\">' +\n                    '<div class=\"fc-cell-content\">' +\n                    '<span class=\"fc-cell-text\">' +\n                    htmlEscape(props.superHeaderText) +\n                    '</span>' +\n                    '</div>' +\n                    '</th>' +\n                    '</tr>';\n        }\n        html += '<tr>';\n        for (var i = 0; i < colSpecs.length; i++) {\n            var o = colSpecs[i];\n            var isLast = i === (colSpecs.length - 1);\n            html +=\n                \"<th class=\\\"\" + theme.getClass('widgetHeader') + \"\\\">\" +\n                    '<div>' +\n                    '<div class=\"fc-cell-content\">' +\n                    (o.isMain ?\n                        '<span class=\"fc-expander-space\">' +\n                            '<span class=\"fc-icon\"></span>' +\n                            '</span>' :\n                        '') +\n                    '<span class=\"fc-cell-text\">' +\n                    htmlEscape(o.labelText || '') + // what about normalizing this value ahead of time?\n                    '</span>' +\n                    '</div>' +\n                    (!isLast ? '<div class=\"fc-col-resizer\"></div>' : '') +\n                    '</div>' +\n                    '</th>';\n        }\n        html += '</tr>';\n        html += '</tbody>';\n        this.tableEl.innerHTML = html;\n        this.thEls = Array.prototype.slice.call(this.tableEl.querySelectorAll('th'));\n        this.colEls = Array.prototype.slice.call(this.tableEl.querySelectorAll('col'));\n        this.resizerEls = Array.prototype.slice.call(this.tableEl.querySelectorAll('.fc-col-resizer'));\n        this.initColResizing();\n    };\n    SpreadsheetHeader.prototype.destroy = function () {\n        for (var _i = 0, _a = this.resizables; _i < _a.length; _i++) {\n            var resizable = _a[_i];\n            resizable.destroy();\n        }\n        this.renderSkeleton.unrender();\n        _super.prototype.destroy.call(this);\n    };\n    SpreadsheetHeader.prototype._renderSkeleton = function (context) {\n        this.parentEl.appendChild(this.tableEl = createElement('table', {\n            className: context.theme.getClass('tableGrid')\n        }));\n    };\n    SpreadsheetHeader.prototype._unrenderSkeleton = function () {\n        removeElement(this.tableEl);\n    };\n    SpreadsheetHeader.prototype.initColResizing = function () {\n        var _this = this;\n        var _a = this.context, calendar = _a.calendar, isRtl = _a.isRtl;\n        var ElementDraggingImpl = calendar.pluginSystem.hooks.elementDraggingImpl;\n        if (ElementDraggingImpl) {\n            this.resizables = this.resizerEls.map(function (handleEl, colIndex) {\n                var dragging = new ElementDraggingImpl(handleEl);\n                var startWidth;\n                dragging.emitter.on('dragstart', function () {\n                    startWidth = _this.colWidths[colIndex];\n                    if (typeof startWidth !== 'number') {\n                        startWidth = _this.thEls[colIndex].getBoundingClientRect().width;\n                    }\n                });\n                dragging.emitter.on('dragmove', function (pev) {\n                    _this.colWidths[colIndex] = Math.max(startWidth + pev.deltaX * (isRtl ? -1 : 1), COL_MIN_WIDTH);\n                    _this.emitter.trigger('colwidthchange', _this.colWidths);\n                });\n                dragging.setAutoScrollEnabled(false); // because gets weird with auto-scrolling time area\n                return dragging;\n            });\n        }\n    };\n    return SpreadsheetHeader;\n}(Component));\n\nvar Spreadsheet = /** @class */ (function (_super) {\n    __extends(Spreadsheet, _super);\n    function Spreadsheet(headParentEl, bodyParentEl) {\n        var _this = _super.call(this) || this;\n        _this.renderSkeleton = memoizeRendering(_this._renderSkeleton, _this._unrenderSkeleton);\n        _this.renderCells = memoizeRendering(_this._renderCells, _this._unrenderCells, [_this.renderSkeleton]);\n        _this.layout = new HeaderBodyLayout(headParentEl, bodyParentEl, 'clipped-scroll');\n        return _this;\n    }\n    Spreadsheet.prototype.render = function (props, context) {\n        this.renderSkeleton(context);\n        this.renderCells(props.superHeaderText, props.colSpecs);\n    };\n    Spreadsheet.prototype.destroy = function () {\n        this.renderCells.unrender();\n        this.renderSkeleton.unrender();\n        this.layout.destroy();\n        _super.prototype.destroy.call(this);\n    };\n    Spreadsheet.prototype._renderSkeleton = function (context) {\n        var _this = this;\n        var bodyEnhancedScroller = this.layout.bodyScroller.enhancedScroll;\n        bodyEnhancedScroller.canvas.contentEl\n            .appendChild(this.bodyContainerEl = createElement('div', { className: 'fc-rows' }, '<table>' +\n            '<colgroup />' +\n            '<tbody />' +\n            '</table>'));\n        this.bodyColGroup = this.bodyContainerEl.querySelector('colgroup');\n        this.bodyTbody = this.bodyContainerEl.querySelector('tbody');\n        var headerEnhancedScroller = this.layout.headerScroller.enhancedScroll;\n        this.header = new SpreadsheetHeader(headerEnhancedScroller.canvas.contentEl);\n        this.header.emitter.on('colwidthchange', function (colWidths) {\n            _this.applyColWidths(colWidths);\n        });\n    };\n    Spreadsheet.prototype._unrenderSkeleton = function () {\n        this.header.destroy();\n    };\n    Spreadsheet.prototype._renderCells = function (superHeaderText, colSpecs) {\n        var colTags = this.renderColTags(colSpecs);\n        this.header.receiveProps({\n            superHeaderText: superHeaderText,\n            colSpecs: colSpecs,\n            colTags: colTags\n        }, this.context);\n        this.bodyColGroup.innerHTML = colTags;\n        this.bodyColEls = Array.prototype.slice.call(this.bodyColGroup.querySelectorAll('col'));\n        this.applyColWidths(colSpecs.map(function (colSpec) { return colSpec.width; }));\n    };\n    Spreadsheet.prototype._unrenderCells = function () {\n        this.bodyColGroup.innerHTML = '';\n    };\n    Spreadsheet.prototype.renderColTags = function (colSpecs) {\n        var html = '';\n        for (var _i = 0, colSpecs_1 = colSpecs; _i < colSpecs_1.length; _i++) {\n            var o = colSpecs_1[_i];\n            if (o.isMain) {\n                html += '<col class=\"fc-main-col\"/>';\n            }\n            else {\n                html += '<col/>';\n            }\n        }\n        return html;\n    };\n    Spreadsheet.prototype.updateSize = function (isResize, totalHeight, isAuto) {\n        this.layout.setHeight(totalHeight, isAuto);\n    };\n    Spreadsheet.prototype.applyColWidths = function (colWidths) {\n        var _this = this;\n        colWidths.forEach(function (colWidth, colIndex) {\n            var headEl = _this.header.colEls[colIndex]; // bad to access child\n            var bodyEl = _this.bodyColEls[colIndex];\n            var styleVal;\n            if (typeof colWidth === 'number') {\n                styleVal = colWidth + 'px';\n            }\n            else if (typeof colWidth == null) {\n                styleVal = '';\n            }\n            headEl.style.width = bodyEl.style.width = styleVal;\n        });\n    };\n    return Spreadsheet;\n}(Component));\n\nvar MIN_RESOURCE_AREA_WIDTH = 30; // definitely bigger than scrollbars\nvar ResourceTimelineView = /** @class */ (function (_super) {\n    __extends(ResourceTimelineView, _super);\n    function ResourceTimelineView() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.isStickyScrollDirty = false;\n        _this.rowNodes = [];\n        _this.rowComponents = [];\n        _this.rowComponentsById = {};\n        _this.resourceAreaWidthDraggings = [];\n        _this.splitter = new ResourceSplitter(); // doesn't let it do businessHours tho\n        _this.renderSkeleton = memoizeRendering(_this._renderSkeleton, _this._unrenderSkeleton);\n        _this.hasResourceBusinessHours = memoize(hasResourceBusinessHours);\n        _this.buildRowNodes = memoize(buildRowNodes);\n        _this.hasNesting = memoize(hasNesting);\n        _this.updateHasNesting = memoizeRendering(_this._updateHasNesting);\n        _this.startInteractive = memoizeRendering(_this._startInteractive, _this._stopInteractive);\n        return _this;\n    }\n    ResourceTimelineView.prototype._startInteractive = function (timeAxisEl) {\n        this.context.calendar.registerInteractiveComponent(this, { el: timeAxisEl });\n    };\n    ResourceTimelineView.prototype._stopInteractive = function () {\n        this.context.calendar.unregisterInteractiveComponent(this);\n    };\n    ResourceTimelineView.prototype.render = function (props, context) {\n        _super.prototype.render.call(this, props, context);\n        this.renderSkeleton(context);\n        var splitProps = this.splitter.splitProps(props);\n        var hasResourceBusinessHours = this.hasResourceBusinessHours(props.resourceStore);\n        this.spreadsheet.receiveProps({\n            superHeaderText: this.superHeaderText,\n            colSpecs: this.colSpecs\n        }, context);\n        this.timeAxis.receiveProps({\n            dateProfileGenerator: props.dateProfileGenerator,\n            dateProfile: props.dateProfile\n        }, context);\n        this.startInteractive(this.timeAxis.slats.el);\n        // for all-resource bg events / selections / business-hours\n        this.lane.receiveProps(__assign({}, splitProps[''], { dateProfile: props.dateProfile, nextDayThreshold: context.nextDayThreshold, businessHours: hasResourceBusinessHours ? null : props.businessHours }), context);\n        var newRowNodes = this.buildRowNodes(props.resourceStore, this.groupSpecs, this.orderSpecs, this.isVGrouping, props.resourceEntityExpansions, context.options.resourcesInitiallyExpanded);\n        this.updateHasNesting(this.hasNesting(newRowNodes));\n        this.diffRows(newRowNodes);\n        this.updateRowProps(props.dateProfile, hasResourceBusinessHours ? props.businessHours : null, // CONFUSING, comment\n        splitProps);\n        this.startNowIndicator(props.dateProfile, props.dateProfileGenerator);\n    };\n    ResourceTimelineView.prototype._renderSkeleton = function (context) {\n        var options = context.options, calendar = context.calendar;\n        var allColSpecs = options.resourceColumns || [];\n        var labelText = options.resourceLabelText; // TODO: view.override\n        var defaultLabelText = 'Resources'; // TODO: view.defaults\n        var superHeaderText = null;\n        if (!allColSpecs.length) {\n            allColSpecs.push({\n                labelText: labelText || defaultLabelText,\n                text: buildResourceTextFunc(options.resourceText, calendar)\n            });\n        }\n        else {\n            superHeaderText = labelText;\n        }\n        var plainColSpecs = [];\n        var groupColSpecs = [];\n        var groupSpecs = [];\n        var isVGrouping = false;\n        var isHGrouping = false;\n        for (var _i = 0, allColSpecs_1 = allColSpecs; _i < allColSpecs_1.length; _i++) {\n            var colSpec = allColSpecs_1[_i];\n            if (colSpec.group) {\n                groupColSpecs.push(colSpec);\n            }\n            else {\n                plainColSpecs.push(colSpec);\n            }\n        }\n        plainColSpecs[0].isMain = true;\n        if (groupColSpecs.length) {\n            groupSpecs = groupColSpecs;\n            isVGrouping = true;\n        }\n        else {\n            var hGroupField = options.resourceGroupField;\n            if (hGroupField) {\n                isHGrouping = true;\n                groupSpecs.push({\n                    field: hGroupField,\n                    text: options.resourceGroupText,\n                    render: options.resourceGroupRender\n                });\n            }\n        }\n        var allOrderSpecs = parseFieldSpecs(options.resourceOrder);\n        var plainOrderSpecs = [];\n        for (var _a = 0, allOrderSpecs_1 = allOrderSpecs; _a < allOrderSpecs_1.length; _a++) {\n            var orderSpec = allOrderSpecs_1[_a];\n            var isGroup = false;\n            for (var _b = 0, groupSpecs_1 = groupSpecs; _b < groupSpecs_1.length; _b++) {\n                var groupSpec = groupSpecs_1[_b];\n                if (groupSpec.field === orderSpec.field) {\n                    groupSpec.order = orderSpec.order; // -1, 0, 1\n                    isGroup = true;\n                    break;\n                }\n            }\n            if (!isGroup) {\n                plainOrderSpecs.push(orderSpec);\n            }\n        }\n        this.superHeaderText = superHeaderText;\n        this.isVGrouping = isVGrouping;\n        this.isHGrouping = isHGrouping;\n        this.groupSpecs = groupSpecs;\n        this.colSpecs = groupColSpecs.concat(plainColSpecs);\n        this.orderSpecs = plainOrderSpecs;\n        // START RENDERING...\n        this.el.classList.add('fc-timeline');\n        if (options.eventOverlap === false) {\n            this.el.classList.add('fc-no-overlap');\n        }\n        this.el.innerHTML = this.renderSkeletonHtml();\n        this.resourceAreaHeadEl = this.el.querySelector('thead .fc-resource-area');\n        this.setResourceAreaWidth(options.resourceAreaWidth);\n        this.initResourceAreaWidthDragging();\n        this.miscHeight = this.el.getBoundingClientRect().height;\n        this.spreadsheet = new Spreadsheet(this.resourceAreaHeadEl, this.el.querySelector('tbody .fc-resource-area'));\n        this.timeAxis = new TimeAxis(this.el.querySelector('thead .fc-time-area'), this.el.querySelector('tbody .fc-time-area'));\n        var timeAxisRowContainer = createElement('div', { className: 'fc-rows' }, '<table><tbody /></table>');\n        this.timeAxis.layout.bodyScroller.enhancedScroll.canvas.contentEl.appendChild(timeAxisRowContainer);\n        this.timeAxisTbody = timeAxisRowContainer.querySelector('tbody');\n        this.lane = new TimelineLane(null, this.timeAxis.layout.bodyScroller.enhancedScroll.canvas.bgEl, this.timeAxis);\n        this.bodyScrollJoiner = new ScrollJoiner('vertical', [\n            this.spreadsheet.layout.bodyScroller,\n            this.timeAxis.layout.bodyScroller\n        ]);\n        // after scrolljoiner\n        this.spreadsheetBodyStickyScroller = new StickyScroller(this.spreadsheet.layout.bodyScroller.enhancedScroll, context.isRtl, true // isVertical\n        );\n    };\n    ResourceTimelineView.prototype._unrenderSkeleton = function (context) {\n        this.startInteractive.unrender(); // \"unrender\" bad name\n        this.destroyRows(); // wierd to call this here\n        this.spreadsheet.destroy();\n        this.timeAxis.destroy();\n        this.lane.destroy();\n        this.spreadsheetBodyStickyScroller.destroy();\n        this.el.classList.remove('fc-timeline');\n        this.el.classList.remove('fc-no-overlap');\n    };\n    ResourceTimelineView.prototype.renderSkeletonHtml = function () {\n        var theme = this.context.theme;\n        return \"<table class=\\\"\" + theme.getClass('tableGrid') + \"\\\"> <thead class=\\\"fc-head\\\"> <tr> <td class=\\\"fc-resource-area \" + theme.getClass('widgetHeader') + \"\\\"></td> <td class=\\\"fc-divider fc-col-resizer \" + theme.getClass('widgetHeader') + \"\\\"></td> <td class=\\\"fc-time-area \" + theme.getClass('widgetHeader') + \"\\\"></td> </tr> </thead> <tbody class=\\\"fc-body\\\"> <tr> <td class=\\\"fc-resource-area \" + theme.getClass('widgetContent') + \"\\\"></td> <td class=\\\"fc-divider fc-col-resizer \" + theme.getClass('widgetHeader') + \"\\\"></td> <td class=\\\"fc-time-area \" + theme.getClass('widgetContent') + \"\\\"></td> </tr> </tbody> </table>\";\n    };\n    ResourceTimelineView.prototype._updateHasNesting = function (isNesting) {\n        var classList = this.el.classList;\n        if (isNesting) {\n            classList.remove('fc-flat');\n        }\n        else {\n            classList.add('fc-flat');\n        }\n    };\n    ResourceTimelineView.prototype.diffRows = function (newNodes) {\n        var oldNodes = this.rowNodes;\n        var oldLen = oldNodes.length;\n        var oldIndexHash = {}; // id -> index\n        var oldI = 0;\n        var newI = 0;\n        for (oldI = 0; oldI < oldLen; oldI++) {\n            oldIndexHash[oldNodes[oldI].id] = oldI;\n        }\n        // iterate new nodes\n        for (oldI = 0, newI = 0; newI < newNodes.length; newI++) {\n            var newNode = newNodes[newI];\n            var oldIFound = oldIndexHash[newNode.id];\n            if (oldIFound != null && oldIFound >= oldI) {\n                this.removeRows(newI, oldIFound - oldI, oldNodes); // won't do anything if same index\n                oldI = oldIFound + 1;\n            }\n            else {\n                this.addRow(newI, newNode);\n            }\n        }\n        // old rows that weren't found need to be removed\n        this.removeRows(newI, oldLen - oldI, oldNodes); // won't do anything if same index\n        this.rowNodes = newNodes;\n    };\n    /*\n    rowComponents is the in-progress result\n    */\n    ResourceTimelineView.prototype.addRow = function (index, rowNode) {\n        var _a = this, rowComponents = _a.rowComponents, rowComponentsById = _a.rowComponentsById;\n        var nextComponent = rowComponents[index];\n        var newComponent = this.buildChildComponent(rowNode, this.spreadsheet.bodyTbody, nextComponent ? nextComponent.spreadsheetTr : null, this.timeAxisTbody, nextComponent ? nextComponent.timeAxisTr : null);\n        rowComponents.splice(index, 0, newComponent);\n        rowComponentsById[rowNode.id] = newComponent;\n    };\n    ResourceTimelineView.prototype.removeRows = function (startIndex, len, oldRowNodes) {\n        if (len) {\n            var _a = this, rowComponents = _a.rowComponents, rowComponentsById = _a.rowComponentsById;\n            for (var i = 0; i < len; i++) {\n                var rowComponent = rowComponents[startIndex + i];\n                rowComponent.destroy();\n                delete rowComponentsById[oldRowNodes[i].id];\n            }\n            rowComponents.splice(startIndex, len);\n        }\n    };\n    ResourceTimelineView.prototype.buildChildComponent = function (node, spreadsheetTbody, spreadsheetNext, timeAxisTbody, timeAxisNext) {\n        if (node.group) {\n            return new GroupRow(spreadsheetTbody, spreadsheetNext, timeAxisTbody, timeAxisNext);\n        }\n        else if (node.resource) {\n            return new ResourceRow(spreadsheetTbody, spreadsheetNext, timeAxisTbody, timeAxisNext, this.timeAxis);\n        }\n    };\n    ResourceTimelineView.prototype.updateRowProps = function (dateProfile, fallbackBusinessHours, splitProps) {\n        var _a = this, rowNodes = _a.rowNodes, rowComponents = _a.rowComponents, context = _a.context;\n        for (var i = 0; i < rowNodes.length; i++) {\n            var rowNode = rowNodes[i];\n            var rowComponent = rowComponents[i];\n            if (rowNode.group) {\n                rowComponent.receiveProps({\n                    spreadsheetColCnt: this.colSpecs.length,\n                    id: rowNode.id,\n                    isExpanded: rowNode.isExpanded,\n                    group: rowNode.group\n                }, context);\n            }\n            else {\n                var resource = rowNode.resource;\n                rowComponent.receiveProps(__assign({}, splitProps[resource.id], { dateProfile: dateProfile, nextDayThreshold: context.nextDayThreshold, businessHours: resource.businessHours || fallbackBusinessHours, colSpecs: this.colSpecs, id: rowNode.id, rowSpans: rowNode.rowSpans, depth: rowNode.depth, isExpanded: rowNode.isExpanded, hasChildren: rowNode.hasChildren, resource: rowNode.resource }), context);\n            }\n        }\n    };\n    ResourceTimelineView.prototype.updateSize = function (isResize, viewHeight, isAuto) {\n        // FYI: this ordering is really important\n        var calendar = this.context.calendar;\n        var isBaseSizing = isResize || calendar.isViewUpdated || calendar.isDatesUpdated || calendar.isEventsUpdated;\n        if (isBaseSizing) {\n            this.syncHeadHeights();\n        }\n        // TODO: don't always call these (but guarding behind isBaseSizing was unreliable)\n        this.timeAxis.updateSize(isResize, viewHeight - this.miscHeight, isAuto);\n        this.spreadsheet.updateSize(isResize, viewHeight - this.miscHeight, isAuto);\n        var rowSizingCnt = this.updateRowSizes(isResize);\n        this.lane.updateSize(isResize); // is efficient. uses flags\n        if (isBaseSizing || rowSizingCnt) {\n            this.bodyScrollJoiner.update();\n            this.timeAxis.layout.scrollJoiner.update(); // hack\n            this.rowPositions = new PositionCache(this.timeAxis.slats.el, this.rowComponents.map(function (rowComponent) {\n                return rowComponent.timeAxisTr;\n            }), false, // isHorizontal\n            true // isVertical\n            );\n            this.rowPositions.build();\n            this.isStickyScrollDirty = true;\n        }\n    };\n    ResourceTimelineView.prototype.syncHeadHeights = function () {\n        var spreadsheetHeadEl = this.spreadsheet.header.tableEl;\n        var timeAxisHeadEl = this.timeAxis.header.tableEl;\n        spreadsheetHeadEl.style.height = '';\n        timeAxisHeadEl.style.height = '';\n        var max = Math.max(spreadsheetHeadEl.getBoundingClientRect().height, timeAxisHeadEl.getBoundingClientRect().height);\n        spreadsheetHeadEl.style.height =\n            timeAxisHeadEl.style.height = max + 'px';\n    };\n    ResourceTimelineView.prototype.updateRowSizes = function (isResize) {\n        var dirtyRowComponents = this.rowComponents;\n        if (!isResize) {\n            dirtyRowComponents = dirtyRowComponents.filter(function (rowComponent) {\n                return rowComponent.isSizeDirty;\n            });\n        }\n        var elArrays = dirtyRowComponents.map(function (rowComponent) {\n            return rowComponent.getHeightEls();\n        });\n        // reset to natural heights\n        for (var _i = 0, elArrays_1 = elArrays; _i < elArrays_1.length; _i++) {\n            var elArray = elArrays_1[_i];\n            for (var _a = 0, elArray_1 = elArray; _a < elArray_1.length; _a++) {\n                var el = elArray_1[_a];\n                el.style.height = '';\n            }\n        }\n        // let rows update their contents' heights\n        for (var _b = 0, dirtyRowComponents_1 = dirtyRowComponents; _b < dirtyRowComponents_1.length; _b++) {\n            var rowComponent = dirtyRowComponents_1[_b];\n            rowComponent.updateSize(isResize); // will reset isSizeDirty\n        }\n        var maxHeights = elArrays.map(function (elArray) {\n            var maxHeight = null;\n            for (var _i = 0, elArray_2 = elArray; _i < elArray_2.length; _i++) {\n                var el = elArray_2[_i];\n                var height = el.getBoundingClientRect().height;\n                if (maxHeight === null || height > maxHeight) {\n                    maxHeight = height;\n                }\n            }\n            return maxHeight;\n        });\n        for (var i = 0; i < elArrays.length; i++) {\n            for (var _c = 0, _d = elArrays[i]; _c < _d.length; _c++) {\n                var el = _d[_c];\n                el.style.height = maxHeights[i] + 'px';\n            }\n        }\n        return dirtyRowComponents.length;\n    };\n    ResourceTimelineView.prototype.destroyRows = function () {\n        for (var _i = 0, _a = this.rowComponents; _i < _a.length; _i++) {\n            var rowComponent = _a[_i];\n            rowComponent.destroy();\n        }\n        this.rowNodes = [];\n        this.rowComponents = [];\n    };\n    ResourceTimelineView.prototype.destroy = function () {\n        for (var _i = 0, _a = this.resourceAreaWidthDraggings; _i < _a.length; _i++) {\n            var resourceAreaWidthDragging = _a[_i];\n            resourceAreaWidthDragging.destroy();\n        }\n        this.renderSkeleton.unrender(); // will call destroyRows\n        _super.prototype.destroy.call(this);\n    };\n    // Now Indicator\n    // ------------------------------------------------------------------------------------------\n    ResourceTimelineView.prototype.getNowIndicatorUnit = function (dateProfile, dateProfileGenerator) {\n        return this.timeAxis.getNowIndicatorUnit(dateProfile, dateProfileGenerator);\n    };\n    ResourceTimelineView.prototype.renderNowIndicator = function (date) {\n        this.timeAxis.renderNowIndicator(date);\n    };\n    ResourceTimelineView.prototype.unrenderNowIndicator = function () {\n        this.timeAxis.unrenderNowIndicator();\n    };\n    // Scrolling\n    // ------------------------------------------------------------------------------------------------------------------\n    // this is useful for scrolling prev/next dates while resource is scrolled down\n    ResourceTimelineView.prototype.queryScroll = function () {\n        var scroll = _super.prototype.queryScroll.call(this);\n        if (this.props.resourceStore) {\n            __assign(scroll, this.queryResourceScroll());\n        }\n        return scroll;\n    };\n    ResourceTimelineView.prototype.applyScroll = function (scroll, isResize) {\n        _super.prototype.applyScroll.call(this, scroll, isResize);\n        if (this.props.resourceStore) {\n            this.applyResourceScroll(scroll);\n        }\n        // avoid updating stickyscroll too often\n        if (isResize || this.isStickyScrollDirty) {\n            this.isStickyScrollDirty = false;\n            this.spreadsheetBodyStickyScroller.updateSize();\n            this.timeAxis.updateStickyScrollers();\n        }\n    };\n    ResourceTimelineView.prototype.computeDateScroll = function (duration) {\n        return this.timeAxis.computeDateScroll(duration);\n    };\n    ResourceTimelineView.prototype.queryDateScroll = function () {\n        return this.timeAxis.queryDateScroll();\n    };\n    ResourceTimelineView.prototype.applyDateScroll = function (scroll) {\n        this.timeAxis.applyDateScroll(scroll);\n    };\n    ResourceTimelineView.prototype.queryResourceScroll = function () {\n        var _a = this, rowComponents = _a.rowComponents, rowNodes = _a.rowNodes;\n        var scroll = {};\n        var scrollerTop = this.timeAxis.layout.bodyScroller.el.getBoundingClientRect().top; // fixed position\n        for (var i = 0; i < rowComponents.length; i++) {\n            var rowComponent = rowComponents[i];\n            var rowNode = rowNodes[i];\n            var el = rowComponent.timeAxisTr;\n            var elBottom = el.getBoundingClientRect().bottom; // fixed position\n            if (elBottom > scrollerTop) {\n                scroll.rowId = rowNode.id;\n                scroll.bottom = elBottom - scrollerTop;\n                break;\n            }\n        }\n        // TODO: what about left scroll state for spreadsheet area?\n        return scroll;\n    };\n    ResourceTimelineView.prototype.applyResourceScroll = function (scroll) {\n        var rowId = scroll.forcedRowId || scroll.rowId;\n        if (rowId) {\n            var rowComponent = this.rowComponentsById[rowId];\n            if (rowComponent) {\n                var el = rowComponent.timeAxisTr;\n                if (el) {\n                    var innerTop = this.timeAxis.layout.bodyScroller.enhancedScroll.canvas.el.getBoundingClientRect().top;\n                    var rowRect = el.getBoundingClientRect();\n                    var scrollTop = (scroll.forcedRowId ?\n                        rowRect.top : // just use top edge\n                        rowRect.bottom - scroll.bottom) - // pixels from bottom edge\n                        innerTop;\n                    this.timeAxis.layout.bodyScroller.enhancedScroll.setScrollTop(scrollTop);\n                    this.spreadsheet.layout.bodyScroller.enhancedScroll.setScrollTop(scrollTop);\n                }\n            }\n        }\n    };\n    // TODO: scrollToResource\n    // Hit System\n    // ------------------------------------------------------------------------------------------\n    ResourceTimelineView.prototype.buildPositionCaches = function () {\n        this.timeAxis.slats.updateSize();\n        this.rowPositions.build();\n    };\n    ResourceTimelineView.prototype.queryHit = function (positionLeft, positionTop) {\n        var rowPositions = this.rowPositions;\n        var slats = this.timeAxis.slats;\n        var rowIndex = rowPositions.topToIndex(positionTop);\n        if (rowIndex != null) {\n            var resource = this.rowNodes[rowIndex].resource;\n            if (resource) { // not a group\n                var slatHit = slats.positionToHit(positionLeft);\n                if (slatHit) {\n                    return {\n                        component: this,\n                        dateSpan: {\n                            range: slatHit.dateSpan.range,\n                            allDay: slatHit.dateSpan.allDay,\n                            resourceId: resource.id\n                        },\n                        rect: {\n                            left: slatHit.left,\n                            right: slatHit.right,\n                            top: rowPositions.tops[rowIndex],\n                            bottom: rowPositions.bottoms[rowIndex]\n                        },\n                        dayEl: slatHit.dayEl,\n                        layer: 0\n                    };\n                }\n            }\n        }\n    };\n    // Resource Area\n    // ------------------------------------------------------------------------------------------------------------------\n    ResourceTimelineView.prototype.setResourceAreaWidth = function (widthVal) {\n        this.resourceAreaWidth = widthVal;\n        applyStyleProp(this.resourceAreaHeadEl, 'width', widthVal || '');\n    };\n    ResourceTimelineView.prototype.initResourceAreaWidthDragging = function () {\n        var _this = this;\n        var _a = this.context, calendar = _a.calendar, isRtl = _a.isRtl;\n        var resourceAreaDividerEls = Array.prototype.slice.call(this.el.querySelectorAll('.fc-col-resizer'));\n        var ElementDraggingImpl = calendar.pluginSystem.hooks.elementDraggingImpl;\n        if (ElementDraggingImpl) {\n            this.resourceAreaWidthDraggings = resourceAreaDividerEls.map(function (el) {\n                var dragging = new ElementDraggingImpl(el);\n                var dragStartWidth;\n                var viewWidth;\n                dragging.emitter.on('dragstart', function () {\n                    dragStartWidth = _this.resourceAreaWidth;\n                    if (typeof dragStartWidth !== 'number') {\n                        dragStartWidth = _this.resourceAreaHeadEl.getBoundingClientRect().width;\n                    }\n                    viewWidth = _this.el.getBoundingClientRect().width;\n                });\n                dragging.emitter.on('dragmove', function (pev) {\n                    var newWidth = dragStartWidth + pev.deltaX * (isRtl ? -1 : 1);\n                    newWidth = Math.max(newWidth, MIN_RESOURCE_AREA_WIDTH);\n                    newWidth = Math.min(newWidth, viewWidth - MIN_RESOURCE_AREA_WIDTH);\n                    _this.setResourceAreaWidth(newWidth);\n                });\n                dragging.setAutoScrollEnabled(false); // because gets weird with auto-scrolling time area\n                return dragging;\n            });\n        }\n    };\n    ResourceTimelineView.needsResourceData = true; // for ResourceViewProps\n    return ResourceTimelineView;\n}(View));\nfunction hasResourceBusinessHours(resourceStore) {\n    for (var resourceId in resourceStore) {\n        var resource = resourceStore[resourceId];\n        if (resource.businessHours) {\n            return true;\n        }\n    }\n    return false;\n}\nfunction hasNesting(nodes) {\n    for (var _i = 0, nodes_1 = nodes; _i < nodes_1.length; _i++) {\n        var node = nodes_1[_i];\n        if (node.group) {\n            return true;\n        }\n        else if (node.resource) {\n            if (node.hasChildren) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\n\nvar main = createPlugin({\n    deps: [ResourceCommonPlugin, TimelinePlugin],\n    defaultView: 'resourceTimelineDay',\n    views: {\n        resourceTimeline: {\n            class: ResourceTimelineView,\n            resourceAreaWidth: '30%',\n            resourcesInitiallyExpanded: true,\n            eventResizableFromStart: true // TODO: not DRY with this same setting in the main timeline config\n        },\n        resourceTimelineDay: {\n            type: 'resourceTimeline',\n            duration: { days: 1 }\n        },\n        resourceTimelineWeek: {\n            type: 'resourceTimeline',\n            duration: { weeks: 1 }\n        },\n        resourceTimelineMonth: {\n            type: 'resourceTimeline',\n            duration: { months: 1 }\n        },\n        resourceTimelineYear: {\n            type: 'resourceTimeline',\n            duration: { years: 1 }\n        }\n    }\n});\n\nexport default main;\nexport { ResourceTimelineView };\n"]},"metadata":{},"sourceType":"module"}